# Functions Reference

| Function                             | Purpose                                                                                                                       | Parameters                                                                             | Returns                                      | Used In                               |
| ------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------- | -------------------------------------------- | ------------------------------------- | ----------------- |
| `addCardToBucket(card, containerId)` | Append a user card to either bucket, keeping public cards before private ones in Completed and managing scroll/jump behavior. | `card` _(HTMLElement)_ – rendered card; `containerId` _(string)_ – target container ID | `void`                                       | `static/submit.js`, `static/retry.js` |
| `fetchUserCard(id)`                  | Fetch a single user card from the server and append it to the correct bucket.                                                 | `id` _(string)_ – Steam identifier                                                     | `Promise<void>`                              | `static/submit.js`                    |
| `handleItemClick(event)`             | Display the item modal using data embedded on the card, logging malformed payloads.                                           | `event` \*(MouseEvent                                                                  | HTMLElement)\* – click event or card element | `void`                                | `static/retry.js` |
| `handleSubmit(e)`                    | Process form submission and launch parallel scans.                                                                            | `e` _(SubmitEvent)_ – form event                                                       | `void`                                       | `static/submit.js`                    |
| `retryInventory(id)`                 | Retry a failed scan and append the updated card to the proper bucket.                                                         | `id` _(string)_ – Steam identifier                                                     | `Promise<void>`                              | `static/retry.js`                     |
| `refreshAll()`                       | Batch retry all failed scans with progress feedback.                                                                          | –                                                                                      | `Promise<void>`                              | `static/retry.js`                     |
| `attachItemModal()`                  | Delegate modal click handling from result containers and attach effect fallback.                                              | –                                                                                      | `void`                                       | `static/retry.js`                     |
| `attachEffectFallback()`             | Remove particle effect images if their source fails to load.                                                                  | –                                                                                      | `void`                                       | `static/retry.js`                     |
| `attachHandlers()`                   | Attach click handlers, modal logic, and search bindings to current cards.                                                     | –                                                                                      | `void`                                       | `static/retry.js`                     |
| `attachUserSearch()`                 | Bind per-user inventory search, caching item names and supporting legacy/new layouts.                                         | –                                                                                      | `void`                                       | `static/retry.js`                     |
| `applyStoredPreferences()`           | Load and apply saved UI display preferences.                                                                                  | –                                                                                      | `void`                                       | `static/ui.js`                        |
| `updateToggleButtons()`              | Reflect active UI modes on global toggle buttons, updating aria-pressed and titles for accessibility.                         | –                                                                                      | `void`                                       | `static/ui.js`                        |
| `toggleCompactMode()`                | Toggle compact density mode and persist preference.                                                                           | –                                                                                      | `void`                                       | `static/ui.js`                        |
| `toggleBorderMode()`                 | Toggle border-only quality mode and persist preference.                                                                       | –                                                                                      | `void`                                       | `static/ui.js`                        |
| `handleUserSearch(event)`            | Filter a user's items by name from the search box.                                                                            | `event` _(Event)_ – input event from search box                                        | `void`                                       | `static/ui.js`                        |
| `attachUserFeatures()`               | Bind search handlers to user cards; used after DOM updates.                                                                   | –                                                                                      | `void`                                       | `static/ui.js`                        |
| `initUI()`                           | Initialize global toggles and per-user search on page load.                                                                   | –                                                                                      | `void`                                       | `static/ui.js`                        |
| `updateRefreshButton()`              | Enable or disable refresh buttons and toggle floating control.                                                                | –                                                                                      | `void`                                       | `static/retry.js`                     |
| `setupFloatingControls()`            | Bind scroll-to-top and floating refresh buttons.                                                                              | –                                                                                      | `void`                                       | `static/retry.js`                     |
| `focusSteamInput()`                  | Focus and select the Steam IDs textarea so it is ready for paste on load.                                                     | –                                                                                      | `void`                                       | `static/retry.js`                     |
| `ensureBackdrop()`                   | Create and reveal the modal backdrop when showing the item modal.                                                             |
| –                                    |
| `void`                               | `static/retry.js`                                                                                                             |
| `centerModal()`                      | Center the modal or dock it as a bottom sheet on small screens.                                                               |
| –                                    |
| `void`                               | `static/retry.js`                                                                                                             |
| `closeModal()`                       | Remove the modal backdrop and close or remove the modal element.                                                              |
| –                                    |
| `void`                               | `static/retry.js`                                                                                                             |
| `getModal()`                         | Retrieve the item modal element.                                                                                              | –                                                                                      | `HTMLDialogElement                           | null`                                 | `static/modal.js` |
| `getBody()`                          | Get the modal body container.                                                                                                 | –                                                                                      | `HTMLElement                                 | null`                                 | `static/modal.js` |
| `openModal()`                        | Display the modal dialog.                                                                                                     | –                                                                                      | `void`                                       | `static/modal.js`                     |
| `populateModal(html)`                | Insert HTML into the modal body.                                                                                              | `html` _(string)_ – markup to render                                                   | `void`                                       | `static/modal.js`                     |
| `closeModal()`                       | Hide the modal and clear contents.                                                                                            | –                                                                                      | `void`                                       | `static/modal.js`                     |
| `updateModal(html)`                  | Update modal content with new HTML.                                                                                           | `html` _(string)_ – new markup                                                         | `void`                                       | `static/modal.js`                     |
| `escapeHtml(str)`                    | Safely escape HTML entities.                                                                                                  | `str` _(string)_ – input string                                                        | `string`                                     | `static/modal.js`                     |
| `generateModalHTML(data)`            | Build HTML for item details.                                                                                                  | `data` _(object)_ – item data                                                          | `string`                                     | `static/modal.js`                     |
| `updateHeader(data)`                 | Populate modal header fields.                                                                                                 | `data` _(object)_ – item data                                                          | `void`                                       | `static/modal.js`                     |
| `renderBadges(badges)`               | Render badge icons in the header.                                                                                             | `badges` _(Array)_ – badge data                                                        | `void`                                       | `static/modal.js`                     |
| `setParticleBackground(effectId)`    | Display particle effect background.                                                                                           | `effectId` _(string\|number)_ – effect id                                              | `void`                                       | `static/modal.js`                     |
| `showItemModal(html)`                | Populate and display the modal.                                                                                               | `html` _(string)_ – markup to show                                                     | `void`                                       | `static/modal.js`                     |
| `initModal()`                        | Attach modal event handlers.                                                                                                  | –                                                                                      | `void`                                       | `static/modal.js`                     |
