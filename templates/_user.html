<div
  id="user-{{ user.steamid }}"
  class="user-card user-box {{ user.status }}{% if user.status == 'failed' %} retry-card{% endif %}"
  data-steamid="{{ user.steamid }}"
>
  <div class="user-header">
    <div class="user-profile">
      <a href="{{ user.profile }}" target="_blank" class="avatar-link">
        <img
          src="{{ user.avatar }}"
          alt="Avatar"
          class="profile-pic"
          loading="lazy"
        />
      </a>
      <div class="profile-details">
        <div class="username">{{ user.username }}</div>
        <div class="tf2-hours">TF2 Playtime: {{ user.playtime }} hrs</div>
        <div class="profile-link">
          <a
            href="https://next.backpack.tf/profiles/{{ user.steamid }}"
            class="backpack-link"
            target="_blank"
            rel="noopener"
          >
            Backpack.tf
            <img
              src="/static/images/logos/bptf_small.PNG"
              alt="Backpack.tf"
              class="inline-icon"
              loading="lazy"
            />
          </a>
        </div>
      </div>
    </div>
    <div class="privacy-status">
      {% if user.status == 'failed' %}
      <button
        class="pill status-pill failed retry-button"
        type="button"
        data-steamid="{{ user.steamid }}"
        aria-label="Retry scan for this user"
      >
        <i class="fa-solid fa-arrows-rotate"></i> Retry
      </button>
      {% else %}
      <span class="pill status-pill {{ user.status }}">
        {% if user.status == 'parsed' %}
        <i class="fa-solid fa-check"></i> Public {% elif user.status ==
        'private' %} <i class="fa-solid fa-lock"></i> Private {% else %}
        <i class="fa-solid fa-arrows-rotate"></i> Failed {% endif %}
      </span>
      {% endif %}
    </div>
  </div>
  <div class="user-controls">
    <div class="search-wrap">
      <input
        class="inv-search"
        type="search"
        placeholder="Search itemsâ€¦"
        aria-label="Search items"
      />
    </div>
    <div class="filters">
      <select class="filter-select" aria-label="Filter items">
        <option value="all">All types</option>
        <option value="unusual">Unusual</option>
        <option value="strange">Strange</option>
        <option value="cosmetic">Cosmetics</option>
        <option value="weapon">Weapons</option>
      </select>
      <select class="extra-select" aria-label="Extra filters">
        <option value="">Any</option>
        <option value="dupe">Duplicates</option>
        <option value="attrs">Has Spells/Paints/Parts</option>
        <option value="value">High value</option>
      </select>
    </div>
  </div>
  <div class="card-body">
    {% if user.status == 'incomplete' %}
    <span class="badge bg-warning text-dark">Fetched but unparsed</span>
    {% elif user.status == 'private' %}
    <span class="badge bg-secondary">Private</span>
    {% endif %}
    <div class="inventory-scroll">
      <button class="scroll-arrow left" type="button" aria-label="Scroll left">
        <i class="fa-solid fa-chevron-left"></i>
      </button>
      <div
        class="inventory-container items"
        data-steamid="{{ user.steamid }}"
        aria-live="polite"
      >
        {% for item in user.items if not item._hidden %} {% set quality_class =
        (item.quality|default('unknown')|lower|replace(' ', '-')) %} {% set
        slot_hint = (item.slot|default('')|lower) %} {% set type_hint =
        (item.type|default('')|lower) %} {% set is_weapon =
        (item.is_weapon|default(false)) or ('weapon' in type_hint) or ('primary'
        in slot_hint) or ('secondary' in slot_hint) or ('melee' in slot_hint) %}
        {% set is_cosmetic = (item.is_cosmetic|default(false)) or ('hat' in
        type_hint) or ('cosmetic' in type_hint) %}
        <div
          class="item-wrapper quality-{{ quality_class }}{% if is_weapon %} is-weapon{% endif %}{% if is_cosmetic %} is-cosmetic{% endif %}{% if item.has_spells or item.has_paint or item.has_parts %} has-attrs{% endif %}{% if item.duplicate_count and item.duplicate_count>1 %} is-duplicate{% endif %}"
          data-quality="{{ quality_class }}"
          data-type="{% if is_weapon %}weapon{% elif is_cosmetic %}cosmetic{% else %}other{% endif %}"
          data-dupe="{% if item.duplicate_count and item.duplicate_count>1 %}1{% else %}0{% endif %}"
          data-attrs="{% if item.has_spells or item.has_paint or item.has_parts %}1{% else %}0{% endif %}"
          data-value-keys="{{ item.value_keys|default(0) }}"
          data-name="{{ item.display_name or item.composite_name }}"
        >
          {% include "item_card.html" %} {% if item.price_string %}
          <div class="item-price">{{ item.formatted_price }}</div>
          {% endif %}
        </div>
        {% endfor %}
      </div>
      <button
        class="scroll-arrow right"
        type="button"
        aria-label="Scroll right"
      >
        <i class="fa-solid fa-chevron-right"></i>
      </button>
    </div>
  </div>
</div>
