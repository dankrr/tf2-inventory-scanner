<div id="user-{{ user.steamid }}" class="user-card">
  <h2>
    <a href="{{ user.profile }}" target="_blank">
      <img src="{{ user.avatar }}" width="64" style="vertical-align: middle; border-radius: 8px;">
    </a>
    {{ user.username }}
    <span class="tf2-hours">TF2 Playtime: {{ user.playtime }} hrs</span>
    <span class="pill status-pill {{ user.status }}{% if user.status == 'failed' %} retry-pill{% endif %}" {% if user.status == 'failed' %}data-steamid="{{ user.steamid }}" title="Retry scan for this user"{% endif %}>
      {% if user.status == 'parsed' %}
        <i class="fa-solid fa-check"></i> Public
      {% elif user.status == 'private' %}
        <i class="fa-solid fa-lock"></i> Private
      {% else %}
        <i class="fa-solid fa-arrows-rotate"></i> Failed
      {% endif %}
    </span>
  </h2>
  <div class="card-body">
    {% if user.status == 'incomplete' %}
      <span class="badge bg-warning text-dark">Fetched but unparsed</span>
    {% elif user.status == 'private' %}
      <span class="badge bg-secondary">Private</span>
    {% endif %}
    <div class="inventory-scroll">
      <button class="scroll-arrow left" type="button" aria-label="Scroll left">
        <i class="fa-solid fa-chevron-left"></i>
      </button>
      <div class="inventory-container">
        {% for item in user.items %}
          {# â†‘ keep border-color for quality #}
          <div class="item-card"
               style="border-color: {{ item.quality_color }};"
               data-item='{{ item|tojson|safe }}'>

            {# â”€â”€â”€ Badge row â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #}
            <div class="item-badges">
              {# Paint dot (uses hex) #}
              {% if item.paint_hex %}
                <span class="paint-dot" style="background-color: {{ item.paint_hex }};" title="Paint: {{ item.paint_name }}"></span>
              {% endif %}

              {# All the *other* badges. Skip the old paint icons (ðŸŽ¨ / ðŸ–Œ) #}
              {% for badge in item.badges %}
                {% if badge.icon not in ['ðŸŽ¨', 'ðŸ–Œ'] %}
                  <span class="badge" data-icon="{{ badge.icon }}"
                        {% if badge.color %} style="color:{{ badge.color }}"{% endif %}
                        title="{{ badge.title }}">{{ badge.icon }}</span>
                {% endif %}
              {% endfor %}
            </div>
            {% if item.image_url %}
              <img class="item-img" src="{{ item.image_url }}" alt="{{ item.name }}" width="64" height="64" onerror="this.style.display='none';">
            {% else %}
              <div class="missing-icon"></div>
            {% endif %}
            <div class="item-name">{{ item.name }}</div>
          </div>
        {% endfor %}
      </div>
      <button class="scroll-arrow right" type="button" aria-label="Scroll right">
        <i class="fa-solid fa-chevron-right"></i>
      </button>
    </div>
  </div>
</div>
